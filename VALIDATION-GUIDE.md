# 🔐 راهنمای کامل اعتبارسنجی فرم

این فایل تمام قوانین اعتبارسنجی فرم کاربران را توضیح می‌دهد.

---

## ✅ قوانین اعتبارسنجی

### 1️⃣ **نام کامل** (الزامی)
```
✅ حداقل: 3 کاراکتر
✅ حداکثر: 50 کاراکتر
❌ خالی نباشد
❌ فقط فاصله نباشد

پیام خطا:
- "نام باید حداقل 3 کاراکتر باشد"
- "نام نباید بیشتر از 50 کاراکتر باشد"

مثال صحیح:
✅ "علی احمدی"
✅ "محمد رضا کریمی"
✅ "Sara Ahmadi"

مثال غلط:
❌ "علی" (کمتر از 3 کاراکتر)
❌ "" (خالی)
❌ "   " (فقط فاصله)
```

---

### 2️⃣ **نام کاربری** (الزامی)
```
✅ حداقل: 3 کاراکتر
✅ حداکثر: 30 کاراکتر
✅ فقط حروف انگلیسی، اعداد و _
❌ فاصله ندارد
❌ کاراکترهای خاص ندارد (به جز _)

پیام خطا:
- "نام کاربری باید حداقل 3 کاراکتر باشد"
- "نام کاربری نباید بیشتر از 30 کاراکتر باشد"
- "نام کاربری فقط می‌تواند شامل حروف انگلیسی، اعداد و _ باشد"

مثال صحیح:
✅ "ali_ahmadi"
✅ "mohammad123"
✅ "user_name_2024"
✅ "john_doe"

مثال غلط:
❌ "ali ahmadi" (دارای فاصله)
❌ "علی_احمدی" (حروف فارسی)
❌ "user@name" (کاراکتر خاص @)
❌ "ab" (کمتر از 3 کاراکتر)
```

---

### 3️⃣ **آدرس ایمیل** (الزامی)
```
✅ فرمت استاندارد ایمیل
✅ حداکثر: 100 کاراکتر
✅ باید @ داشته باشد
✅ باید دامنه معتبر داشته باشد

پیام خطا:
- "لطفاً یک آدرس ایمیل معتبر وارد کنید"
- "ایمیل نباید بیشتر از 100 کاراکتر باشد"

Regex Pattern:
/^[^\s@]+@[^\s@]+\.[^\s@]+$/

مثال صحیح:
✅ "ali@example.com"
✅ "mohammad.rezaei@company.co.ir"
✅ "user+tag@domain.com"
✅ "test123@mail.org"

مثال غلط:
❌ "aliexample.com" (بدون @)
❌ "ali@" (بدون دامنه)
❌ "@example.com" (بدون نام)
❌ "ali @example.com" (دارای فاصله)
❌ "ali@example" (بدون TLD)
```

---

### 4️⃣ **شماره تلفن** (الزامی)
```
✅ حداقل: 10 رقم (بدون علائم)
✅ می‌تواند شامل: اعداد، فاصله، - ، + ، ( ، )
✅ فقط اعداد و علائم مجاز

پیام خطا:
- "لطفاً یک شماره تلفن معتبر وارد کنید"
- "شماره تلفن باید حداقل 10 رقم باشد"

Regex Pattern:
/^[\d\s\-\+\(\)]+$/

مثال صحیح:
✅ "09123456789"
✅ "+98 912 345 6789"
✅ "(021) 1234-5678"
✅ "021-12345678"
✅ "+1 (555) 123-4567"

مثال غلط:
❌ "123456" (کمتر از 10 رقم)
❌ "abcd123456" (حروف دارد)
❌ "912-abc-5678" (حروف دارد)
❌ "" (خالی)
```

---

### 5️⃣ **وبسایت** (اختیاری)
```
✅ فرمت URL معتبر
✅ می‌تواند http:// یا https:// داشته باشد
✅ می‌تواند www داشته باشد یا نداشته باشد
❌ اگر پر شود، باید معتبر باشد

پیام خطا:
- "لطفاً یک آدرس وبسایت معتبر وارد کنید"

Regex Pattern:
/^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b/

مثال صحیح:
✅ "example.com"
✅ "www.example.com"
✅ "https://example.com"
✅ "https://www.example.com/page"
✅ "sub.domain.com"
✅ "" (خالی - چون اختیاری است)

مثال غلط:
❌ "example" (بدون TLD)
❌ "http://" (ناقص)
❌ "www." (ناقص)
❌ "not a url" (فرمت نادرست)
```

---

### 6️⃣ **شهر** (اختیاری)
```
✅ حداقل: 2 کاراکتر (اگر پر شود)
✅ می‌تواند خالی باشد
✅ می‌تواند فارسی یا انگلیسی باشد

پیام خطا:
- "نام شهر باید حداقل 2 کاراکتر باشد"

مثال صحیح:
✅ "تهران"
✅ "Tehran"
✅ "New York"
✅ "اصفهان"
✅ "" (خالی - چون اختیاری است)

مثال غلط:
❌ "ت" (یک کاراکتر)
❌ "A" (یک کاراکتر)
```

---

### 7️⃣ **نام شرکت** (اختیاری)
```
✅ حداقل: 2 کاراکتر (اگر پر شود)
✅ می‌تواند خالی باشد
✅ می‌تواند فارسی یا انگلیسی باشد

پیام خطا:
- "نام شرکت باید حداقل 2 کاراکتر باشد"

مثال صحیح:
✅ "شرکت نمونه"
✅ "Example Company"
✅ "Google Inc."
✅ "کاوش تجارت"
✅ "" (خالی - چون اختیاری است)

مثال غلط:
❌ "A" (یک کاراکتر)
❌ "ش" (یک کاراکتر)
```

---

## 🎨 نمایش خطاها در UI

### نمایش خطای هر فیلد:
```tsx
{validationErrors.name && (
  <motion.p
    initial={{ opacity: 0, y: -10 }}
    animate={{ opacity: 1, y: 0 }}
    exit={{ opacity: 0, y: -10 }}
    className="text-red-500 text-sm mt-1"
  >
    {validationErrors.name}
  </motion.p>
)}
```

### استایل فیلد با خطا:
```tsx
className={`
  ${validationErrors.name 
    ? 'border-red-500 bg-red-50'    // ❌ دارای خطا
    : 'border-gray-200'              // ✅ عادی
  }
`}
```

---

## 📝 مثال استفاده

### 1. در کامپوننت:
```tsx
import { useUserForm } from '@/hooks/useUserForm';

const MyComponent = () => {
  const { 
    validationErrors,    // خطاهای اعتبارسنجی
    createUser,          // تابع ایجاد کاربر
    loading              // وضعیت loading
  } = useUserForm();

  const handleSubmit = async (formData: FormData) => {
    const success = await createUser(formData);
    if (success) {
      toast.success('کاربر با موفقیت ایجاد شد!');
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      {/* فیلدها */}
    </form>
  );
};
```

### 2. نمایش خطا:
```tsx
<input
  name="name"
  className={validationErrors.name ? 'error' : ''}
/>
{validationErrors.name && (
  <span className="error-message">
    {validationErrors.name}
  </span>
)}
```

---

## 🧪 تست اعتبارسنجی

### چک لیست تست:

#### نام:
- [ ] خالی → خطا
- [ ] "ab" → خطا (کمتر از 3)
- [ ] "علی احمدی" → ✅
- [ ] 51 کاراکتر → خطا

#### نام کاربری:
- [ ] خالی → خطا
- [ ] "ab" → خطا (کمتر از 3)
- [ ] "ali ahmadi" → خطا (فاصله)
- [ ] "علی" → خطا (فارسی)
- [ ] "ali@123" → خطا (کاراکتر خاص)
- [ ] "ali_ahmadi" → ✅

#### ایمیل:
- [ ] خالی → خطا
- [ ] "test" → خطا
- [ ] "test@" → خطا
- [ ] "@test.com" → خطا
- [ ] "test @test.com" → خطا (فاصله)
- [ ] "test@example.com" → ✅

#### تلفن:
- [ ] خالی → خطا
- [ ] "123" → خطا (کمتر از 10 رقم)
- [ ] "abc123" → خطا (حروف)
- [ ] "09123456789" → ✅
- [ ] "+98 912 345 6789" → ✅

#### وبسایت (اختیاری):
- [ ] خالی → ✅
- [ ] "example" → خطا
- [ ] "example.com" → ✅
- [ ] "https://example.com" → ✅

#### شهر (اختیاری):
- [ ] خالی → ✅
- [ ] "ت" → خطا
- [ ] "تهران" → ✅

#### شرکت (اختیاری):
- [ ] خالی → ✅
- [ ] "A" → خطا
- [ ] "Google" → ✅

---

## 💡 نکات مهم

### 1. اعتبارسنجی Real-time:
```tsx
// خطاها بلافاصله بعد از submit نمایش داده می‌شوند
// نه حین تایپ کردن
```

### 2. پاک کردن خطاها:
```tsx
const { clearErrors } = useUserForm();

// پاک کردن تمام خطاها:
clearErrors();
```

### 3. فیلدهای الزامی:
```
✅ الزامی: name, username, email, phone
❌ اختیاری: website, city, companyName
```

### 4. پیام‌های خطا:
```
✅ تمام پیام‌ها فارسی هستند
✅ پیام‌ها واضح و قابل فهم هستند
✅ هر فیلد پیام خاص خود را دارد
```

---

## 🎯 خلاصه

| فیلد | الزامی | حداقل | حداکثر | ویژگی خاص |
|------|--------|-------|--------|-----------|
| نام | ✅ | 3 | 50 | - |
| نام کاربری | ✅ | 3 | 30 | فقط a-z, 0-9, _ |
| ایمیل | ✅ | - | 100 | فرمت ایمیل |
| تلفن | ✅ | 10 رقم | - | اعداد و علائم |
| وبسایت | ❌ | - | - | فرمت URL |
| شهر | ❌ | 2 | - | - |
| شرکت | ❌ | 2 | - | - |

---

## 🚀 بهبودهای انجام شده

### قبل:
```tsx
❌ پیام‌های انگلیسی
❌ validation ساده
❌ بدون چک طول
❌ بدون validation فیلدهای اختیاری
```

### بعد:
```tsx
✅ تمام پیام‌ها فارسی
✅ validation کامل
✅ چک حداقل و حداکثر طول
✅ validation فیلدهای اختیاری
✅ Regex بهتر برای فرمت‌ها
✅ پیام‌های دقیق‌تر
✅ چک کاراکترهای مجاز
```

---

**موفق باشید! 🎉**

برای سوالات بیشتر به [FARSI-CHANGES.md](./FARSI-CHANGES.md) مراجعه کنید.
